//Post-Sales V3.2

choose "<h2><font size=\"4\"><h2><font color=\"BLUE\">What Quote do you want to check?<h2><font size=\"3\"><p><font color=\"RED\"><br> For reissue, please make sure to add the new segments before proceeding!.</font></p></font></h2></font></h2></font></h2>"{
    when ("Reissue") {
        assign "Reissue" to quoteType
    }
    when ("Refund") {
        assign "Refund" to quoteType
    }
}

send "TTH/ALL"
capture line:2, column:75, length:6 assign to old_segments_No
capture line:3, column:75, length:6 assign to old_segments_No_1
if (old_segments_No_1 != old_segments_No){
  append old_segments_No_1 to old_segments_No
}
  send "RTA"
if (quoteType == "Reissue"){
    group{
    mandatory ask "<h2><font size=\"3\"><font color=\"BLUE\">Please enter the NEW segments no...<br>Please enter the full route!</font></font></h2>"
    with format "^\d{1,3}([-,]\d{1,3})*$" assign to new_segments_No
    mandatory ask "<h2><font size=\"4\"><font color=\"RED\">Please enter the original segments no.</font></font></h2>" 
    with format "^\d{1,3}([-,]\d{1,3})*$" assign to old_segments_No
    }
}
if (quoteType == "Refund"){
  group{        
  ask "<h2><font size=\"3\"><font color=\"BLUE\">Please enter the (Possible) USED segments no... (Original Classes for Elevate!)</font></font></h2>"
  with format "^\d{1,3}([-,]\d{1,3})*$" assign to used_segments_No
  mandatory ask "<h2><font size=\"4\"><font color=\"RED\">Please enter the original segments no.</font></font></h2>" 
  with format "^\d{1,3}([-,]\d{1,3})*$" assign to old_segments_No
  }
}

send "TTH/ALL"

capture line:1, column:1, length:13 assign to TQT_Checker
if (TQT_Checker !="NO ACTIVE TST"){


  capture line:2, column:1, length:3 assign to TQTNumber1
  capture line:2, column:42, length:10 assign to TQTPrice1
  capture line:3, column:1, length:3 assign to TQTNumber2
  capture line:3, column:42, length:10 assign to TQTPrice2
  capture line:4, column:1, length:3 assign to TQTNumber3
  capture line:4, column:42, length:10 assign to TQTPrice3
  capture line:5, column:1, length:3 assign to TQTNumber4
  capture line:5, column:42, length:10 assign to TQTPrice4
  capture line:6, column:1, length:3 assign to TQTNumber5
  capture line:6, column:42, length:10 assign to TQTPrice5
  capture line:7, column:1, length:3 assign to TQTNumber6
  capture line:7, column:42, length:10 assign to TQTPrice6
  capture line:8, column:1, length:3 assign to TQTNumber7
  capture line:8, column:42, length:10 assign to TQTPrice7
  capture line:9, column:1, length:3 assign to TQTNumber8
  capture line:9, column:42, length:10 assign to TQTPrice8
  capture line:10, column:1, length:3 assign to TQTNumber9
  capture line:10, column:42, length:10 assign to TQTPrice9
  capture line:11, column:1, length:3 assign to TQTNumber10
  capture line:11, column:42, length:10 assign to TQTPrice10
  capture line:12, column:1, length:3 assign to TQTNumber11
  capture line:12, column:42, length:10 assign to TQTPrice11
  capture line:13, column:1, length:3 assign to TQTNumber12
  capture line:13, column:42, length:10 assign to TQTPrice12
  capture line:14, column:1, length:3 assign to TQTNumber13
  capture line:14, column:42, length:10 assign to TQTPrice13
  capture line:15, column:1, length:3 assign to TQTNumber14
  capture line:15, column:42, length:10 assign to TQTPrice14
  capture line:16, column:1, length:3 assign to TQTNumber15
  capture line:16, column:42, length:10 assign to TQTPrice15
  capture line:17, column:1, length:3 assign to TQTNumber16
  capture line:17, column:42, length:10 assign to TQTPrice16
  capture line:18, column:1, length:3 assign to TQTNumber17
  capture line:18, column:42, length:10 assign to TQTPrice17
  capture line:19, column:1, length:3 assign to TQTNumber18
  capture line:19, column:42, length:10 assign to TQTPrice18

  assign "0" to heighestTST
  if (TQTNumber1=="DEL"){
    assign "0" to TQTNumber1
  } 
  if (TQTNumber1==""){
    assign "0" to TQTNumber1
  }
  if (TQTNumber2=="DEL"){
    assign "0" to TQTNumber2
  } 
  if (TQTNumber2==""){
    assign "0" to TQTNumber2
  }
  if (TQTNumber3=="DEL"){
    assign "0" to TQTNumber3
  } 
  if (TQTNumber3==""){
    assign "0" to TQTNumber3
  }
  if (TQTNumber4=="DEL"){
    assign "0" to TQTNumber4
  } 
  if (TQTNumber4==""){
    assign "0" to TQTNumber4
  }
  if (TQTNumber5=="DEL"){
    assign "0" to TQTNumber5
  } 
  if (TQTNumber5==""){
    assign "0" to TQTNumber5
  }
  if (TQTNumber6=="DEL"){
    assign "0" to TQTNumber6
  } 
  if (TQTNumber6==""){
    assign "0" to TQTNumber6
  }
  if (TQTNumber7=="DEL"){
    assign "0" to TQTNumber7
  } 
  if (TQTNumber7==""){
    assign "0" to TQTNumber7
  }
  if (TQTNumber8=="DEL"){
    assign "0" to TQTNumber8
  } 
  if (TQTNumber8==""){
    assign "0" to TQTNumber8
  }
  if (TQTNumber9=="DEL"){
    assign "0" to TQTNumber9
  } 
  if (TQTNumber9==""){
    assign "0" to TQTNumber9
  }
  if (TQTNumber10=="DEL"){
    assign "0" to TQTNumber10
  } 
  if (TQTNumber10==""){
    assign "0" to TQTNumber10
  }
  if (TQTNumber11=="DEL"){
    assign "0" to TQTNumber11
  } 
  if (TQTNumber11==""){
    assign "0" to TQTNumber11
  }
  if (TQTNumber12=="DEL"){
    assign "0" to TQTNumber12
  } 
  if (TQTNumber12==""){
    assign "0" to TQTNumber12
  }
  if (TQTNumber13=="DEL"){
    assign "0" to TQTNumber13
  } 
  if (TQTNumber13==""){
    assign "0" to TQTNumber13
  }
  if (TQTNumber14=="DEL"){
    assign "0" to TQTNumber14
  } 
  if (TQTNumber14==""){
    assign "0" to TQTNumber14
  }
  if (TQTNumber15=="DEL"){
    assign "0" to TQTNumber15
  } 
  if (TQTNumber15==""){
    assign "0" to TQTNumber15
  }
  if (TQTNumber16=="DEL"){
    assign "0" to TQTNumber16
  } 
  if (TQTNumber16==""){
    assign "0" to TQTNumber16
  }
  if (TQTNumber17=="DEL"){
    assign "0" to TQTNumber17
  } 
  if (TQTNumber17==""){
    assign "0" to TQTNumber17
  }
  if (TQTNumber18=="DEL"){
    assign "0" to TQTNumber18
  } 
  if (TQTNumber18==""){
    assign "0" to TQTNumber18
  }

  if (TQTPrice1 =="E TTH     "){
      assign "0" to TQTPrice1
  }
  if (TQTPrice2 =="E TTH     "){
      assign "0" to TQTPrice2
  }
  if (TQTPrice3 =="E TTH     "){
      assign "0" to TQTPrice3
  }
  if (TQTPrice4 =="E TTH     "){
      assign "0" to TQTPrice4
  }
  if (TQTPrice5 =="E TTH     "){
      assign "0" to TQTPrice5
  }
  if (TQTPrice6 =="E TTH     "){
      assign "0" to TQTPrice6
  }
  if (TQTPrice7 =="E TTH     "){
      assign "0" to TQTPrice7
  }
  if (TQTPrice8 =="E TTH     "){
      assign "0" to TQTPrice8
  }
  if (TQTPrice9 =="E TTH     "){
      assign "0" to TQTPrice9
  }
  if (TQTPrice10 =="E TTH     "){
      assign "0" to TQTPrice10
  }
  if (TQTPrice11 =="E TTH     "){
      assign "0" to TQTPrice11
  }
  if (TQTPrice12 =="E TTH     "){
      assign "0" to TQTPrice12
  }
  if (TQTPrice13 =="E TTH     "){
      assign "0" to TQTPrice13
  }
  if (TQTPrice14 =="E TTH     "){
      assign "0" to TQTPrice14
  }
  if (TQTPrice15 =="E TTH     "){
      assign "0" to TQTPrice15
  }
  if (TQTPrice16 =="E TTH     "){
      assign "0" to TQTPrice16
  }
  if (TQTPrice17 =="E TTH     "){
      assign "0" to TQTPrice17
  }
  if (TQTPrice18 =="E TTH     "){
      assign "0" to TQTPrice18
  }

  assign "0" to heighestPrice
        
  if (TQTNumber1!="0"){
    if (TQTPrice1>heighestPrice){
      assign TQTNumber1 to heighestTST
      assign TQTPrice1 to heighestPrice
    }
  }
  if (TQTNumber2!="0"){
    if (TQTPrice2>heighestPrice){
      assign TQTNumber2 to heighestTST
      assign TQTPrice2 to heighestPrice
    }
  }
  if (TQTNumber3!="0"){
    if (TQTPrice3>heighestPrice){
      assign TQTNumber3 to heighestTST
      assign TQTPrice3 to heighestPrice
    }
  }
  if (TQTNumber4!="0"){
    if (TQTPrice4>heighestPrice){
      assign TQTNumber4 to heighestTST
      assign TQTPrice4 to heighestPrice
    }
  }
  if (TQTNumber5!="0"){
    if (TQTPrice5>heighestPrice){
      assign TQTNumber5 to heighestTST
      assign TQTPrice5 to heighestPrice
    }
  }
  if (TQTNumber6!="0"){
    if (TQTPrice6>heighestPrice){
      assign TQTNumber6 to heighestTST
      assign TQTPrice6 to heighestPrice
    }
  }
  if (TQTNumber7!="0"){
    if (TQTPrice7>heighestPrice){
      assign TQTNumber7 to heighestTST
      assign TQTPrice7 to heighestPrice
    }
  }
  if (TQTNumber8!="0"){
    if (TQTPrice8>heighestPrice){
      assign TQTNumber8 to heighestTST
      assign TQTPrice8 to heighestPrice
    }
  }
  if (TQTNumber9!="0"){
    if (TQTPrice9>heighestPrice){
      assign TQTNumber9 to heighestTST
      assign TQTPrice9 to heighestPrice
    }
  }
  if (TQTNumber10!="0"){
    if (TQTPrice10>heighestPrice){
      assign TQTNumber10 to heighestTST
      assign TQTPrice10 to heighestPrice
    }
  }
  if (TQTNumber11!="0"){
    if (TQTPrice11>heighestPrice){
      assign TQTNumber11 to heighestTST
      assign TQTPrice11 to heighestPrice
    }
  }
  if (TQTNumber12!="0"){
    if (TQTPrice12>heighestPrice){
      assign TQTNumber12 to heighestTST
      assign TQTPrice12 to heighestPrice
    }
  }
  if (TQTNumber13!="0"){
    if (TQTPrice13>heighestPrice){
      assign TQTNumber13 to heighestTST
      assign TQTPrice13 to heighestPrice
    }
  }
  if (TQTNumber14!="0"){
    if (TQTPrice14>heighestPrice){
      assign TQTNumber14 to heighestTST
      assign TQTPrice14 to heighestPrice
    }
  }
  if (TQTNumber15!="0"){
    if (TQTPrice15>heighestPrice){
      assign TQTNumber15 to heighestTST
      assign TQTPrice15 to heighestPrice
    }
  }
  if (TQTNumber16!="0"){
    if (TQTPrice16>heighestPrice){
      assign TQTNumber16 to heighestTST
      assign TQTPrice16 to heighestPrice
    }
  }
  if (TQTNumber17!="0"){
    if (TQTPrice17>heighestPrice){
      assign TQTNumber17 to heighestTST
      assign TQTPrice17 to heighestPrice
    }
  }
  if (TQTNumber18!="0"){
    if (TQTPrice18>heighestPrice){
      assign TQTNumber18 to heighestTST
      assign TQTPrice18 to heighestPrice
    }
  }

}else{
  send "TTH"
  mandatory ask "Please enter the Same (Non INF) TTH Number as issued ticket... " with format "^\s*\d{1,3}\s*$" assign to heighestTST
}
  mandatory ask "Please enter the Same (Non INF) TTH Number as issued ticket... " with format "^\s*\d{1,3}\s*$" assign to heighestTST

  send "TTH/T" +heighestTST

assign "" to faresCount
    // First Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:1 assign to fareBasis1
        append "           " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:2 assign to fareBasis1
        append "          " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:3 assign to fareBasis1
        append "         " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:4 assign to fareBasis1
        append "        " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:5 assign to fareBasis1
        append "       " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:6 assign to fareBasis1
        append "      " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:7 assign to fareBasis1
        append "     " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:8 assign to fareBasis1
        append "    " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:9 assign to fareBasis1
        append "   " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:10 assign to fareBasis1
        append "  " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:11 assign to fareBasis1
        append " " to fareBasis1
        append "1" to faresCount
      }
      else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis1_Shortcut
        capture line:1, column:6, length:12 assign to fareBasis1
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }

    // Second Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1 != "BOTT"){
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis2
        append "           " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis2
        append "          " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis2
        append "         " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis2
        append "        " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:5 assign to fareBasis2
        append "       " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:6 assign to fareBasis2
        append "      " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:7 assign to fareBasis2
        append "     " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:8 assign to fareBasis2
        append "    " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:9 assign to fareBasis2
        append "   " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:10 assign to fareBasis2
        append "  " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:11 assign to fareBasis2
        append " " to fareBasis2
        append "1" to faresCount
      }
      else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:12 assign to fareBasis2
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }
    
    // Third Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1 != "BOTT"){
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis3
        append "           " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis3
        append "          " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis3
        append "         " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis3
        append "        " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:5 assign to fareBasis3
        append "       " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:6 assign to fareBasis3
        append "      " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:7 assign to fareBasis3
        append "     " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:8 assign to fareBasis3
        append "    " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:9 assign to fareBasis3
        append "   " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:10 assign to fareBasis3
        append "  " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:11 assign to fareBasis3
        append " " to fareBasis3
        append "1" to faresCount
      }
      else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:12 assign to fareBasis3
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }
    
    // Fourth Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1 != "BOTT"){
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis4
        append "           " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis4
        append "          " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis4
        append "         " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis4
        append "        " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:5 assign to fareBasis4
        append "       " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:6 assign to fareBasis4
        append "      " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:7 assign to fareBasis4
        append "     " to fareBasis4
        append "1" to faresCount
      }
      else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:8 assign to fareBasis4
        append "    " to fareBasis4
        append "1" to faresCount
      }else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:9 assign to fareBasis4
        append "   " to fareBasis4
        append "1" to faresCount
      }else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:10 assign to fareBasis4
        append "  " to fareBasis4
        append "1" to faresCount
      }else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:11 assign to fareBasis4
        append " " to fareBasis4
        append "1" to faresCount
      }else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:12 assign to fareBasis4
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }
    
    // Fifth Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1 != "BOTT"){
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis5
        append "           " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis5
        append "          " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis5
        append "         " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis5
        append "        " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:5 assign to fareBasis5
        append "       " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:6 assign to fareBasis5
        append "      " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:7 assign to fareBasis5
        append "     " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:8 assign to fareBasis5
        append "    " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:9 assign to fareBasis5
        append "   " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:10 assign to fareBasis5
        append "  " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:11 assign to fareBasis5
        append " " to fareBasis5
        append "1" to faresCount
      }else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:12 assign to fareBasis5
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }
    
    // Sixth Capture fareBasis
    send "MD-AB  "
    capture line:1, column:1, length:4 assign to AB1
    if (AB1 != "BOTT"){
    if (AB1=="AB  "){
      capture line:1, column:7, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:1 assign to fareBasis6
        append "           " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:8, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:2 assign to fareBasis6
        append "          " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:9, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:3 assign to fareBasis6
        append "         " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:10, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:4 assign to fareBasis6
        append "        " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:11, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:5 assign to fareBasis6
        append "       " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:12, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:6 assign to fareBasis6
        append "      " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:13, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:7 assign to fareBasis6
        append "     " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:14, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:8 assign to fareBasis6
        append "    " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:15, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:9 assign to fareBasis6
        append "   " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:16, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:10 assign to fareBasis6
        append "  " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:17, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:11 assign to fareBasis6
        append " " to fareBasis6
        append "1" to faresCount
      }else{
      capture line:1, column:18, length:1 assign to space_Check
      if (space_Check == " "){
        capture line:1, column:6, length:12 assign to fareBasis6
        append "1" to faresCount
      }
      }//18
      }//17
      }//16
      }//15
      }//14
      }//13
      }//12
      }//11
      }//10
      }//9
      }//8
    }
    
    }//BOTT6

    }//BOTT5

    }//BOTT4

    }//BOTT3

    }//BOTT2


    send "MT" 

    // Baggage Checker
    send "MD-AA  "
    capture line:1, column:1, length:4 assign to AA1
    if (AA1=="AA  "){
      capture line:1, column:6, length:2 assign to Bg1
      capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight1
          capture line:1, column:23, length:7 assign to flight1_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight1_p1
        capture line:1, column:16, length:11 assign to flight1_p2
        append flight1_p1 +" "+ flight1_p2 to flight1
        capture line:1, column:22, length:7 assign to flight1_date
      }    
    }
    if (faresCount>"1"){
      send "MD-AA  "
      capture line:1, column:1, length:4 assign to AA1
      if (AA1=="AA  "){
        capture line:1, column:6, length:2 assign to Bg2
        capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight2
          capture line:1, column:23, length:7 assign to flight2_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight2_p1
        capture line:1, column:16, length:11 assign to flight2_p2
        append flight2_p1 +" "+ flight2_p2 to flight2
        capture line:1, column:22, length:7 assign to flight2_date
      }  
      }
    }
    if (faresCount>"11"){
      send "MD-AA  "
      capture line:1, column:1, length:4 assign to AA1
      if (AA1=="AA  "){
        capture line:1, column:6, length:2 assign to Bg3
        capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight3
          capture line:1, column:23, length:7 assign to flight3_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight3_p1
        capture line:1, column:16, length:11 assign to flight3_p2
        append flight3_p1 +" "+ flight3_p2 to flight3
        capture line:1, column:22, length:7 assign to flight3_date
      }  
      }
    }
    if (faresCount>"111"){
      send "MD-AA  "
      capture line:1, column:1, length:4 assign to AA1
      if (AA1=="AA  "){
        capture line:1, column:6, length:2 assign to Bg4
        capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight4
          capture line:1, column:23, length:7 assign to flight4_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight4_p1
        capture line:1, column:16, length:11 assign to flight4_p2
        append flight4_p1 +" "+ flight4_p2 to flight4
        capture line:1, column:22, length:7 assign to flight4_date
      }  
      }
    }
    if (faresCount>"1111"){
      send "MD-AA  "
      capture line:1, column:1, length:4 assign to AA1
      if (AA1=="AA  "){
        capture line:1, column:6, length:2 assign to Bg5
        capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight5
          capture line:1, column:23, length:7 assign to flight5_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight5_p1
        capture line:1, column:16, length:11 assign to flight5_p2
        append flight5_p1 +" "+ flight5_p2 to flight5
        capture line:1, column:22, length:7 assign to flight5_date
      }  
      }
    }
    if (faresCount>"11111"){
      send "MD-AA  "
      capture line:1, column:1, length:4 assign to AA1
      if (AA1=="AA  "){
        capture line:1, column:6, length:2 assign to Bg6
        capture line:1, column:19, length:1 assign to flight_check
      if (flight_check >= "1"){
        if (flight_check <= "9"){
          capture line:1, column:14, length:14 assign to flight6
          capture line:1, column:23, length:7 assign to flight6_date
        }
      }
      else{
        capture line:1, column:14, length:2 assign to flight6_p1
        capture line:1, column:16, length:11 assign to flight6_p2
        append flight6_p1 +" "+ flight6_p2 to flight6
        capture line:1, column:22, length:7 assign to flight6_date
      }  
      }
    }

if (Bg1 =="  "){
    assign "0p" to Bg1
}
if (Bg1 =="NO"){
    assign "0p" to Bg1
}

if (Bg2 =="  "){
    assign "0p" to Bg2
}
if (Bg2 =="NO"){
    assign "0p" to Bg2
}

if (Bg3 =="  "){
    assign "0p" to Bg3
}
if (Bg3 =="NO"){
    assign "0p" to Bg3
}

if (Bg4 =="  "){
    assign "0p" to Bg4
}
if (Bg4 =="NO"){
    assign "0p" to Bg4
}

if (Bg5 =="  "){
    assign "0p" to Bg5
}
if (Bg5 =="NO"){
    assign "0p" to Bg5
}

if (Bg6 =="  "){
    assign "0p" to Bg6
}
if (Bg6 =="NO"){
    assign "0p" to Bg6
}


  // getting the issuing city and date of issue
  send "MT" 
  send "MD-RF-"

  capture line:1, column:5, length:2 assign to RF1
  if (RF1 == "RF"){
    capture line:1, column:15, length:3 assign to issuing_City
    capture line:1, column:35, length:5 assign to DOI
  }
  else{
    send "MD-RF-"
    capture line:1, column:5, length:2 assign to RF1
    if (RF1 == "RF"){
      capture line:1, column:15, length:3 assign to issuing_City
      capture line:1, column:35, length:5 assign to DOI
    }
  }


  
  //send "DD" +today + "/" +flight1_date 
  //capture line:2, column:1, length:1 assign to checkpast
  //capture line:2, column:2, length:2 assign to checktoday
    if (checkpast == "-"){
        assign "Passed" to flight1_status
    }
    else{
      if (checktoday == "0"){
          assign "Passed" to flight1_status
      }
      if (checktoday == "1"){
          assign "Passed" to flight1_status
      }
      if (checktoday >"1"){
          assign "Future" to flight1_status
      }
    }


  send "MT" 
  send "MD-AD "
  capture line:1, column:6, length:3 assign to OB_City
  capture line:1, column:9, length:3 assign to IB_City
  if (OB_City == IB_City){
    assign "True" to RoundTrip
  }

  send "DD"
  capture line:2, column:38, length:2 assign to YY_DOI
  send "DD" +today +"/" +DOI +YY_DOI
  capture line:2, column:1, length:1 assign to check_Before_After
  capture line:2, column:2, length:1 assign to check_today
  if (check_Before_After != "-"){
    if (check_today != "0"){
    send "DF" +YY_DOI +"-1"
    capture line:2, column:1, length:2 assign to YY_DOI
    }
    else{
      send "RTTN"
      mandatory ask date "The Date of Issue is in the past, please check!" with format DDMONYY assign to DOY
    }
  }
  else{
    
  }
  append YY_DOI to DOI
  if (check_today == "0"){
    assign DOY to DOI
  }


  if (quoteType == "Reissue"){
    send "FXX/RADT," +issuing_City +"/S" +new_segments_No
    capture line:1, column:11, length:9 assign to check_FXX_Success
    if (check_FXX_Success == "PAST DATE"){
      send "FXX/RADT," +DOI +"," +issuing_City +"/S" +new_segments_No
    }

    capture line:3, column:1, length:11 assign to check_FXX_Success
    if (check_FXX_Success == "FUTURE DATE"){
        send "FXX/RADT," +DOI +"," +issuing_City +"/S" +new_segments_No
    }

    capture line:3, column:1, length:9 assign to check_FXX_Success
    if (check_FXX_Success == "*NO FARES"){
        mandatory ask "No Pricinig available for the requested segments(s)!" assign to qz5
    }

    send "FQQ1"
   
        capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }
    
    send "FQQ2"
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){

        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ3"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9

      }

      send "FQQ4"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9

      }

      send "FQQ5"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ6"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ7"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ8"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ9"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ10"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ11"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }

        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }

      send "FQQ12"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
                capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (faresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (faresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (faresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (faresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (faresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to new_Fare_Currency
            assign Fare_Amount2 to new_Fare_Amount
            }
        }
        }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 != ""){
        if (Currency2 != "   "){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalNewPrice
          }
        }
        }
        capture line:6, column:1, length:60 assign to fare_line1
        capture line:7, column:1, length:60 assign to fare_line2
        capture line:8, column:1, length:60 assign to fare_line3
        capture line:9, column:1, length:60 assign to fare_line4
        capture line:10, column:1, length:60 assign to fare_line5
        capture line:11, column:1, length:60 assign to fare_line6
        capture line:12, column:1, length:60 assign to fare_line7
        capture line:13, column:1, length:60 assign to fare_line8
        capture line:14, column:1, length:60 assign to fare_line9
      }  
          
    }//12
      
    }//11
      
    }//10
      
    }//9
      
    }//8
      
    }//7
      
    }//6
      
    }//5
      
    }//4
      
    }//3
      
    }//2
    

  }//Reissue
  
  
  if (quoteType == "Refund"){
    assign "0" to totalUsedPrice
    if (used_segments_No != ""){
      send "FXX/RADT," +DOI +",RUH/S" +used_segments_No
      send "FQQ1"
   
        capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }


  
    

      if (check_Baggage_Compatibility == "True"){


            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
    
    send "FQQ2"
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }


    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      

      if (check_Baggage_Compatibility == "True"){
   
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ3"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ4"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ5"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ6"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ7"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ8"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ9"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ10"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ11"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    if (fBg1 ==""){
        assign "0p" to fBg1
    }
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }    

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
      send "FQQ12"
      capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened != "CHECK SEQUENCE"){
      capture line:6, column:59, length:2 assign to baggage1
        if (baggage1=="BG"){
          assign "1" to used_FaresCount
          capture line:9, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:10, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:11, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:12, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:13, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
      capture line:8, column:59, length:2 assign to fBg1
          if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:13, column:59, length:2 assign to fBg6
            }
        
          capture line:9, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
        
        }
        }

        capture line:10, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
        }

        capture line:11, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:12, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }

          capture line:13, column:11, length:13 assign to check_Surface_Connection
          if (check_Surface_Connection == "S U R F A C E"){
            if (faresCount == "11"){
                capture line:9, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:9, column:59, length:2 assign to fBg2
                capture line:10, column:59, length:2 assign to fBg3
                capture line:11, column:59, length:2 assign to fBg4
                capture line:12, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:7, column:59, length:2 assign to baggage2
        if (baggage2=="BG"){
          assign "1" to used_FaresCount
          capture line:10, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:11, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:12, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:13, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:14, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:9, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:14, column:59, length:2 assign to fBg6
            }

            capture line:10, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
            }

        capture line:13, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
        }

        capture line:14, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:10, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:10, column:59, length:2 assign to fBg2
                capture line:11, column:59, length:2 assign to fBg3
                capture line:12, column:59, length:2 assign to fBg4
                capture line:13, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }
          }
        }

        capture line:8, column:59, length:2 assign to baggage3
        if (baggage3=="BG"){
          assign "1" to used_FaresCount
          capture line:11, column:2, length:20 assign to check_Seg
          if (check_Seg != ""){
            append "1" to used_FaresCount
            capture line:12, column:2, length:20 assign to check_Seg
            if (check_Seg != ""){
              append "1" to used_FaresCount
              capture line:13, column:2, length:20 assign to check_Seg
              if (check_Seg != ""){
                append "1" to used_FaresCount
                capture line:14, column:2, length:20 assign to check_Seg
                if (check_Seg != ""){
                  append "1" to used_FaresCount
                  capture line:15, column:2, length:20 assign to check_Seg
                  if (check_Seg != ""){
                    append "1" to used_FaresCount
                  }
                }
              }
            }
          }
            capture line:10, column:59, length:2 assign to fBg1

            if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:15, column:59, length:2 assign to fBg6
            }

            capture line:11, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:12, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:12, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:12, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:13, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:13, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:14, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

            capture line:14, column:11, length:13 assign to check_Surface_Connection
            if (check_Surface_Connection == "S U R F A C E"){
              if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:15, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
            }

        capture line:15, column:11, length:13 assign to check_Surface_Connection
        if (check_Surface_Connection == "S U R F A C E"){
          if (faresCount == "11"){
                capture line:11, column:59, length:2 assign to fBg2
            }
            if (faresCount == "111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
            }
            if (faresCount == "1111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
            }
            if (faresCount == "11111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
            }
            if (faresCount == "111111"){
                capture line:11, column:59, length:2 assign to fBg2
                capture line:12, column:59, length:2 assign to fBg3
                capture line:13, column:59, length:2 assign to fBg4
                capture line:14, column:59, length:2 assign to fBg5
                capture line:16, column:59, length:2 assign to fBg6
            }
        }
        }

    
    if (fBg1 =="NO"){
        assign "0p" to fBg1
    }
    if (fBg1 =="0 "){
        assign "0P" to fBg1
    }

    if (fBg2 ==""){
        assign "0p" to fBg2
    }
    if (fBg2 =="NO"){
        assign "0p" to fBg2
    }
    if (fBg2 =="0 "){
        assign "0P" to fBg2
    }
        
    if (fBg3 ==""){
        assign "0p" to fBg3
    }
    if (fBg3 =="NO"){
        assign "0p" to fBg3
    }
    if (fBg3 =="0 "){
        assign "0P" to fBg3
    }

    if (fBg4 ==""){
        assign "0p" to fBg4
    }
    if (fBg4 =="NO"){
        assign "0p" to fBg4
    }
    if (fBg4 =="0 "){
        assign "0P" to fBg4
    }
            
    if (fBg5 ==""){
        assign "0p" to fBg5
    }
    if (fBg5 =="NO"){
        assign "0p" to fBg5
    }
    if (fBg5 =="0 "){
        assign "0P" to fBg5
    }        

    if (fBg6 ==""){
        assign "0p" to fBg6
    }
    if (fBg6 =="NO"){
        assign "0p" to fBg6
    }
    if (fBg6 =="0 "){
        assign "0P" to fBg6
    }

    assign "False" to check_Baggage_Compatibility
    if (fBg1 >= Bg1){
      assign "True" to check_Baggage_Compatibility
      if (used_FaresCount>"1"){
        assign  "False" to check_Baggage_Compatibility
        if (fBg2 >= Bg2){
          assign "True" to check_Baggage_Compatibility
          if (used_FaresCount>"11"){
            assign "False" to check_Baggage_Compatibility
            if (fBg3 >= Bg3){
              assign "True" to check_Baggage_Compatibility
              if (used_FaresCount>"111"){
                assign "False" to check_Baggage_Compatibility
                if (fBg4 >= Bg4){
                  assign "True" to check_Baggage_Compatibility
                  if (used_FaresCount>"1111"){
                    assign "False" to check_Baggage_Compatibility
                    if (fBg5 >= Bg5){
                      assign "True" to check_Baggage_Compatibility
                      if (used_FaresCount>"11111"){
                        assign "False" to check_Baggage_Compatibility
                        if (fBg6 >= Bg6){
                          assign "True" to check_Baggage_Compatibility
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }

      if (check_Baggage_Compatibility == "True"){
      
  
            
        capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Fare_Amount2 to totalUsedPrice
          }
        }
        }
      }
    }//12
    }//11
    }//10
    }//9
    }//8
    }//7
    }//6
    }//5
    }//4
    }//3
    }//2 

    }
  }
  
  send "FXX/RADT," +DOI +"," +issuing_City +"/S" +old_segments_No
  
  capture line:4, column:1, length:2 assign to FXXN1
  capture line:5, column:1, length:2 assign to FXXN2
  capture line:6, column:1, length:2 assign to FXXN3
  capture line:7, column:1, length:2 assign to FXXN4
  capture line:8, column:1, length:2 assign to FXXN5
  capture line:9, column:1, length:2 assign to FXXN6
  capture line:10, column:1, length:2 assign to FXXN7
  capture line:11, column:1, length:2 assign to FXXN8
  capture line:12, column:1, length:2 assign to FXXN9
  capture line:13, column:1, length:2 assign to FXXN10
  capture line:14, column:1, length:2 assign to FXXN11
  capture line:15, column:1, length:2 assign to FXXN12
  capture line:16, column:1, length:2 assign to FXXN13
  capture line:17, column:1, length:2 assign to FXXN14
  capture line:18, column:1, length:2 assign to FXXN15
  capture line:19, column:1, length:2 assign to FXXN16
  capture line:20, column:1, length:2 assign to FXXN17

  capture line:4, column:4, length:4 assign to FXXFareRule1
  capture line:5, column:4, length:4 assign to FXXFareRule2
  capture line:6, column:4, length:4 assign to FXXFareRule3
  capture line:7, column:4, length:4 assign to FXXFareRule4
  capture line:8, column:4, length:4 assign to FXXFareRule5
  capture line:9, column:4, length:4 assign to FXXFareRule6
  capture line:10, column:4, length:4 assign to FXXFareRule7
  capture line:11, column:4, length:4 assign to FXXFareRule8
  capture line:12, column:4, length:4 assign to FXXFareRule9
  capture line:13, column:4, length:4 assign to FXXFareRule10
  capture line:14, column:4, length:4 assign to FXXFareRule11
  capture line:15, column:4, length:4 assign to FXXFareRule12
  capture line:16, column:4, length:4 assign to FXXFareRule13
  capture line:17, column:4, length:4 assign to FXXFareRule14
  capture line:18, column:4, length:4 assign to FXXFareRule15
  capture line:19, column:4, length:4 assign to FXXFareRule16
  capture line:20, column:4, length:4 assign to FXXFareRule17



  assign "False" to check_FareBasis_Compatibility
  if (FXXFareRule1 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN1 
    
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN1 
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN1 
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "1" to FXXfareBasisNumber
    }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule2 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN2 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN2 
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN2 
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "2" to FXXfareBasisNumber
    }
  }
  }
  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule2 == "----"){
    assign "True" to check_FareBasis_Compatibility

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "1" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule3 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN3 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN3 
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN3 
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "3" to FXXfareBasisNumber
    }
  }
  }
  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule3 == "----"){
    assign "True" to check_FareBasis_Compatibility

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "1" to FXXfareBasisNumber
    }
  }
  }


  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule4 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN4 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN4
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN4
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "4" to FXXfareBasisNumber
    }
  }
  }
  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule4 == "----"){
    assign "True" to check_FareBasis_Compatibility

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "1" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule5 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN5 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN5
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN5
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "5" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule6 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN6 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN6
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN6
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "6" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule7 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN7 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN7
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN7
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "7" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule8 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN8 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN8
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN8
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "8" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule9 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN9 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN9
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN9
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "9" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule10 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN10

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN10
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN10
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "10" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule11 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN11 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN11
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN11
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "11" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule12 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN12 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN12
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN12
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "13" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule14 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN14 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN14
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN14
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "14" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule15 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN15

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN15
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN15
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "15" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule16 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN16

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN16
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN16
    } 

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "16" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    if (FXXFareRule17 == fareBasis1_Shortcut){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ" +FXXN17 

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN17
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXXN17
    }

    capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "17" to FXXfareBasisNumber
    }
  }
  }

  if (check_FareBasis_Compatibility == "False"){
    assign "True" to check_FareBasis_Compatibility
    send "FQQ1"
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ1" 
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ1" 
    }

  capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign "1" to FXXfareBasisNumber
    }
 }

 if (check_FareBasis_Compatibility == "False"){
  assign "True" to check_FareBasis_Compatibility
  mandatory ask "Please Enter The FareRule No:" assign to FXX_test_FareRule_Number
  send "FQQ" +FXX_test_FareRule_Number

    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXX_test_FareRule_Number
    }
    capture line:3, column:1, length:14 assign to check_FQQ_Opened
    if (check_FQQ_Opened == "CHECK SEQUENCE"){
      send "FQQ" +FXX_test_FareRule_Number
    }

  capture line:9, column:32, length:12 assign to FQQfareBasis1
    if (FQQfareBasis1 != fareBasis1){
      assign "False" to check_FareBasis_Compatibility
    }

    if (faresCount>"1"){
      capture line:10, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:11, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:10, column:32, length:12 assign to FQQfareBasis2
        if (FQQfareBasis2 != fareBasis2){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11"){
      capture line:11, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:12, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:11, column:32, length:12 assign to FQQfareBasis3
        if (FQQfareBasis3 != fareBasis3){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"111"){
      capture line:12, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:13, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:12, column:32, length:12 assign to FQQfareBasis4
        if (FQQfareBasis4 != fareBasis4){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"1111"){
      capture line:13, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:14, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:13, column:32, length:12 assign to FQQfareBasis5
        if (FQQfareBasis5 != fareBasis5){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (faresCount>"11111"){
      capture line:14, column:11, length:13 assign to check_Surface_Connection
      if (check_Surface_Connection == "S U R F A C E"){
        capture line:15, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
      else{
        capture line:14, column:32, length:12 assign to FQQfareBasis6
        if (FQQfareBasis6 != fareBasis6){
          assign "False" to check_FareBasis_Compatibility
        }
      }
    }

    if (check_FareBasis_Compatibility == "True"){
      assign FXX_test_FareRule_Number to FXXfareBasisNumber
    }
 }

  if (check_FareBasis_Compatibility == "False"){
    send "Can't Find The Fare Rule!"
    ask "Please Continue manually!" assign to fq5
 }

 send "FQQ" +FXXfareBasisNumber 
 

  capture line:8, column:1, length:3 assign to Currency1
        capture line:9, column:1, length:3 assign to Currency2
        capture line:9, column:4, length:9 assign to Fare_Amount2
        capture line:10, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }

        capture line:9, column:1, length:3 assign to Currency1
        capture line:10, column:1, length:3 assign to Currency2
        capture line:10, column:4, length:9 assign to Fare_Amount2
        capture line:11, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:10, column:1, length:3 assign to Currency1
        capture line:11, column:1, length:3 assign to Currency2
        capture line:11, column:4, length:9 assign to Fare_Amount2
        capture line:12, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:11, column:1, length:3 assign to Currency1
        capture line:12, column:1, length:3 assign to Currency2
        capture line:12, column:4, length:9 assign to Fare_Amount2
        capture line:13, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:12, column:1, length:3 assign to Currency1
        capture line:13, column:1, length:3 assign to Currency2
        capture line:13, column:4, length:9 assign to Fare_Amount2
        capture line:14, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:13, column:1, length:3 assign to Currency1
        capture line:14, column:1, length:3 assign to Currency2
        capture line:14, column:4, length:9 assign to Fare_Amount2
        capture line:15, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:14, column:1, length:3 assign to Currency1
        capture line:15, column:1, length:3 assign to Currency2
        capture line:15, column:4, length:9 assign to Fare_Amount2
        capture line:16, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:15, column:1, length:3 assign to Currency1
        capture line:16, column:1, length:3 assign to Currency2
        capture line:16, column:4, length:9 assign to Fare_Amount2
        capture line:17, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:16, column:1, length:3 assign to Currency1
        capture line:17, column:1, length:3 assign to Currency2
        capture line:17, column:4, length:9 assign to Fare_Amount2
        capture line:18, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:17, column:1, length:3 assign to Currency1
        capture line:18, column:1, length:3 assign to Currency2
        capture line:18, column:4, length:9 assign to Fare_Amount2
        capture line:19, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:18, column:1, length:3 assign to Currency1
        capture line:19, column:1, length:3 assign to Currency2
        capture line:19, column:4, length:9 assign to Fare_Amount2
        capture line:20, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:19, column:1, length:3 assign to Currency1
        capture line:20, column:1, length:3 assign to Currency2
        capture line:20, column:4, length:9 assign to Fare_Amount2
        capture line:21, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 != Currency1){
          if (Currency2 == Currency3){
            assign Currency1 to original_Fare_Currency
            assign Fare_Amount2 to original_Fare_Amount
            }
        }
        }
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

        capture line:20, column:1, length:3 assign to Currency1
        capture line:21, column:1, length:3 assign to Currency2
        capture line:21, column:4, length:9 assign to Fare_Amount2
        capture line:22, column:1, length:3 assign to Currency3
        if (Currency2 != "FAR"){
        if (Currency2 == Currency1){
          if (Currency2 != Currency3){
            assign Currency2 to oldCurrency
            assign Fare_Amount2 to totalOldPrice
          }
        }
        }

  
  assign "1" to Fares
  if (faresCount>"1"){
    if (fareBasis1 != fareBasis2){
      append "1" to Fares
    }
  }
  if (faresCount>"11"){
    if (fareBasis2 != fareBasis3){
      append "1" to Fares
    }
  }
  if (faresCount>"111"){
    if (fareBasis3 != fareBasis4){
      append "1" to Fares
    }
  }
  if (faresCount>"1111"){
    if (fareBasis4 != fareBasis5){
      append "1" to Fares
    }
  }
  if (faresCount>"11111"){
    if (fareBasis5 != fareBasis6){
      append "1" to Fares
    }
  }
  
  if (quoteType == "Reissue"){

    send "DF"  +totalNewPrice + ";" +totalNewPrice +"*0.15" +"-" +totalOldPrice 
  capture line:2, column:1, length:10 assign to FareDiff
capture line:6, column:1, length:1 assign to dfnextcheck
if (dfnextcheck == ">"){
    capture line:4, column:1, length:10 assign to FareDiff
}
capture line:5, column:1, length:1 assign to dfnextcheck
if (dfnextcheck == ">"){
    capture line:3, column:1, length:10 assign to FareDiff
}
capture line:4, column:1, length:1 assign to dfnextcheck
if (dfnextcheck == ">"){
    capture line:2, column:1, length:10 assign to FareDiff
}

  send "FQC" +FareDiff +oldCurrency +"/SAR"
  capture line:2, column:1, length: 13 assign to check_Amount_Verification
  if (check_Amount_Verification == "VERIFY AMOUNT"){
    capture line:1, column:5, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:1 assign to verified_Amount
    }
    capture line:1, column:6, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:2 assign to verified_Amount
    }
    capture line:1, column:7, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:3 assign to verified_Amount
    }
    capture line:1, column:8, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:4 assign to verified_Amount
    }
    capture line:1, column:9, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:5 assign to verified_Amount
    }
    capture line:1, column:10, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:6 assign to verified_Amount
    }
    capture line:1, column:11, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:7 assign to verified_Amount
    }
    capture line:1, column:12, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:8 assign to verified_Amount
    }
    capture line:1, column:13, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:9 assign to verified_Amount
    }

    send "FQC" +verified_Amount +oldCurrency +"/SAR"
  }
    capture line:5, column:7, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:2 assign to FareDiff
    }
    capture line:5, column:8, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:3 assign to FareDiff
    }
    capture line:5, column:9, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:4 assign to FareDiff
    }
    capture line:5, column:10, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:5 assign to FareDiff
    }
    capture line:5, column:11, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:6 assign to FareDiff
    }
    capture line:5, column:12, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:7 assign to FareDiff
    }
    capture line:5, column:13, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:8 assign to FareDiff
    }
    capture line:5, column:14, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:9 assign to FareDiff
    }
    capture line:5, column:15, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:10 assign to FareDiff
    }
    capture line:5, column:16, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:11 assign to FareDiff
    }
    capture line:5, column:17, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:12 assign to FareDiff
    }

    send "FQN" +FXXfareBasisNumber +"*PE"
    send "MD-Changes"

  if (Fares == "11"){
    send "FQN" +FXXfareBasisNumber +"-2*PE"
    send "MD-Changes"
  }
  if (Fares == "111"){
    send "FQN" +FXXfareBasisNumber +"-3*PE"
    send "MD-Changes"
  }
  if (Fares == "1111"){
    send "FQN" +FXXfareBasisNumber +"-4*PE"
    send "MD-Changes"
  }
  if (Fares == "11111"){
    send "FQN" +FXXfareBasisNumber +"-5*PE"
    send "MD-Changes"
  }
  if (Fares == "111111"){
    send "FQN" +FXXfareBasisNumber +"-6*PE"
    send "MD-Changes"
  }

  if (original_Fare_Currency == new_Fare_Currency){
    if (new_Fare_Amount >= original_Fare_Amount){
      send "" + fare_line1 +"
 " + fare_line2 +"
 " + fare_line3 +"
 " + fare_line4 +"
 " + fare_line5 +"
 " + fare_line6 +"
 " + fare_line7 +"
 " + fare_line8 +"
 " + fare_line9 +"
 "  +"
 "  +"Reissue Charges = SAR " +" " +FareDiff +" + Penalty"
    }
    else{
      send "" + fare_line1 +"
 " + fare_line2 +"
 " + fare_line3 +"
 " + fare_line4 +"
 " + fare_line5 +"
 " + fare_line6 +"
 " + fare_line7 +"
 " + fare_line8 +"
 " + fare_line9 +"
 "  +"
 "  +"Reissue Charges = SAR " +" " +FareDiff +" + Penalty (Not Guranteed please check if fare Downgraded)"
    }
  }
  else{
    send "" + fare_line1 +"
 " + fare_line2 +"
 " + fare_line3 +"
 " + fare_line4 +"
 " + fare_line5 +"
 " + fare_line6 +"
 " + fare_line7 +"
 " + fare_line8 +"
 " + fare_line9 +"
 "  +"
 "  +"Reissue Charges = SAR " +" " +FareDiff +" + Penalty (Not Guranteed Different Fare Currency)"
  }

  }

  if (quoteType == "Refund"){

    send "DF " +totalOldPrice +"*0.15"
       capture line:2, column:1, length:10 assign to Deducted
      capture line:6, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:4, column:1, length:10 assign to Deducted
    }
    capture line:5, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:3, column:1, length:10 assign to Deducted
    }
    capture line:4, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:2, column:1, length:10 assign to Deducted
    }

    send "FQC" +Deducted +oldCurrency +"/SAR"
    capture line:2, column:1, length: 13 assign to check_Amount_Verification
  if (check_Amount_Verification == "VERIFY AMOUNT"){
    capture line:1, column:5, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:1 assign to verified_Amount
    }
    capture line:1, column:6, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:2 assign to verified_Amount
    }
    capture line:1, column:7, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:3 assign to verified_Amount
    }
    capture line:1, column:8, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:4 assign to verified_Amount
    }
    capture line:1, column:9, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:5 assign to verified_Amount
    }
    capture line:1, column:10, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:6 assign to verified_Amount
    }
    capture line:1, column:11, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:7 assign to verified_Amount
    }
    capture line:1, column:12, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:8 assign to verified_Amount
    }
    capture line:1, column:13, length:1 assign to check_FQC_Dot
    if (check_FQC_Dot == "."){
      capture line:1, column:4, length:9 assign to verified_Amount
    }

    send "FQC" +verified_Amount +oldCurrency +"/SAR"
  }
    capture line:5, column:7, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:2 assign to Deducted
    }
    capture line:5, column:8, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:3 assign to Deducted
    }
    capture line:5, column:9, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:4 assign to Deducted
    }
    capture line:5, column:10, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:5 assign to Deducted
    }
    capture line:5, column:11, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:6 assign to Deducted
    }
    capture line:5, column:12, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:7 assign to Deducted
    }
    capture line:5, column:13, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:8 assign to Deducted
    }
    capture line:5, column:14, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:9 assign to Deducted
    }
    capture line:5, column:15, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:10 assign to Deducted
    }
    capture line:5, column:16, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:11 assign to Deducted
    }
    capture line:5, column:17, length:1 assign to check_Final_Dash
    if (check_Final_Dash == "-"){
        capture line:5, column:5, length:12 assign to Deducted
    }

    if (used_segments_No != ""){
      send "DF " +totalUsedPrice + ";" +totalUsedPrice +"*0.15" +";" +Deducted
      capture line:2, column:1, length:10 assign to Deducted
      capture line:6, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:4, column:1, length:10 assign to Deducted
    }
    capture line:5, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:3, column:1, length:10 assign to Deducted
    }
    capture line:4, column:1, length:1 assign to dfnextcheck
    if (dfnextcheck == ">"){
      capture line:2, column:1, length:10 assign to Deducted
    }
    }
    

    send "FQN" +FXXfareBasisNumber +"*PE"
    send "MD-Cancellations"

  if (Fares == "11"){
    send "FQN" +FXXfareBasisNumber +"-2*PE"
    send "MD-Cancellations"
  }
  if (Fares == "111"){
    send "FQN" +FXXfareBasisNumber +"-3*PE"
    send "MD-Cancellations"
  }
  if (Fares == "1111"){
    send "FQN" +FXXfareBasisNumber +"-4*PE"
    send "MD-Cancellations"
  }
  if (Fares == "11111"){
    send "FQN" +FXXfareBasisNumber +"-5*PE"
    send "MD-Cancellations"
  }
  if (Fares == "111111"){
    send "FQN" +FXXfareBasisNumber +"-6*PE"
    send "MD-Cancellations"
  }
  if (used_segments_No != ""){
    send "Total Deductions: Penalty + SAR " +Deducted +" (Used Segment(s) & NRF Taxes)"
  }
  else{
    send "Total Deductions: Penalty + SAR" +" " +Deducted +" (NRF Taxes)"
  }
   
  }

